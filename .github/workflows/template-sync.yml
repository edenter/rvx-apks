name: Sync with Template
on:
  schedule:
    - cron: "0 0 * * 1" # Runs weekly on Mondays
  workflow_dispatch:   # Allows manual triggering

jobs:
  sync:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          # Note: If your branch is "Protected", you must use a PAT instead of GITHUB_TOKEN
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Sync and Push Directly
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          
          # Add the source template
          git remote add template github.com
          git fetch template
          
          # Merge changes directly into your current branch
          # --allow-unrelated-histories helps if the repos were created separately
          git merge template/main --allow-unrelated-histories -m "chore: sync with template [skip ci]"
          
          # Push directly to your main branch
          git push origin HEAD:main
